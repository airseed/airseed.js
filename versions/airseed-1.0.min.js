window.airseed=function(){var e="Airseed: Missing client ID. Please call airseed.init('...') with valid client ID first.";var t="Airseed: Missing CSS selector to bind click event.";var n="Airseed: Missing authentication provider for Airseed auth. Please provide 'gmail', 'yahoo', or 'outlook'.";var r="Airseed: Invalid selector. Unable to locate specified elements on page.";var s="Airseed: Received invalid user access token.";var o="Airseed: Failed to fetch /v1/users/me.json endpoint info.";var u=["selector","provider","flow","callbackUrl"];var a="popup_window";var f="page_redirect";var l="https://auth.airseed.com";var c="https://api.airseed.com";var h=500;var p=500;var d={};var v;var m=function(e){var t;if(typeof e==="string"){t=document.querySelectorAll(e)}else if(e.length){t=e}else{t=[e]}return t};var g=function(){return v._authBaseUrl||l};var y=function(){return v._apiBaseUrl||c};var b=function(e,t){var n=g()+"/oauth/authenticate?provider="+t.provider+"&client_id="+e;for(var r in t){if(u.indexOf(r)<0){var i=r.replace(/([A-Z])/g,function(e){return"_"+e.toLowerCase()});var s=t[r];n+="&"+i+"="+s}}return encodeURI(n)};var w=function(e,t,n){var r=Math.random().toString(36).substring(7);var i=screen.width/2-h/2;var s=screen.height/2-p/2;var o=window.open(e+"&clientside=js",r,"toolbar=yes, scrollbars=yes, resizable=yes, width="+h+", height="+p+" top="+s+", left="+i);d[r]={callbackUrl:t,popupWindow:o,provider:n}};var E=function(e,t){window.location.href=e+="&redirect_uri="+t};var S=function(e,t){for(i=0;i<e.length;i++){e[i].addEventListener("click",function(){var e=b(v._appClientId,t);if(t.flow==a){w(e,t.callbackUrl,t.provider)}else{E(e,t.callbackUrl)}})}};var x=function(e){try{return JSON.parse(e)}catch(t){v._failureCallback({message:s});throw s}};var T=function(e){try{return JSON.parse(e)}catch(t){v._failureCallback({message:o});throw o}};var N=function(e){var t=new XMLHttpRequest;t.onload=function(){var n=T(t.responseText);if(n){v._successCallback(n)}else{v._failureCallback({message:o})}};t.open("get",y()+"/v1/users/me.json",true);t.setRequestHeader("Authorization","Bearer "+e.access_token);t.send()};var C=function(e,t){var n=[];for(var r in e){if(e.hasOwnProperty(r)){n.push(encodeURIComponent(r)+"="+encodeURIComponent(e[r]))}}var i=t+"?"+n.join("&");window.location.href=i};var k=function(e){if(e.origin!==g())return;if(!e.data.access_token)return;var t=d[e.data.popupName].callbackUrl;var n=new XMLHttpRequest;n.onload=function(){var i=x(n.responseText);if(!i)return;if(!t){N(e.data)}else{C(e.data,t)}};n.open("get",g()+"/oauth/tokeninfo?access_token="+e.data.access_token,true);n.send()};var L=function(){window.addEventListener("message",k,false)};v={init:function(e){this._appClientId=e;this._failureCallback=function(){};this._successCallback=function(){};L()},bind:function(i){if(!this._appClientId)throw e;if(!i.selector)throw t;if(!i.provider)throw n;var s=m(i.selector);if(!s)throw r;S(s,i)},success:function(e){this._successCallback=e},failure:function(e){this._failureCallback=e},config:function(e){this._authBaseUrl=e.authBaseUrl;this._apiBaseUrl=e.apiBaseUrl}};return v}()